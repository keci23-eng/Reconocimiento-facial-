{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Crear usuario</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
  <link rel="icon" href="{% static 'images/logo.png' %}" type="image/png">
</head>

<body class="app-bg">

  <div class="page-wrap">
    <div class="container app-shell">

      <!-- TOPBAR -->
      <header class="topbar-pro">
        <div class="topbar-left">
          <div class="app-brand">
            <div class="logo">RF</div>
            <div>
              <div class="brand-title">Administración</div>
              <div class="breadcrumbs">
                <span>Usuarios</span>
                <span class="crumb-sep">/</span>
                <span class="crumb-active">Crear</span>
              </div>
            </div>
          </div>

          <div class="topbar-meta">
            <span class="chip chip-muted">Gestión de accesos</span>
          </div>
        </div>

        <div class="topbar-actions">
          <a href="/app/" class="btn btn-outline-secondary btn-sm btn-soft">
            Volver
          </a>
        </div>
      </header>

      <!-- HERO -->
      <section class="hero-strip">
        <div class="hero-copy">
          <div class="hero-title">Crear nuevo usuario</div>
          <div class="hero-sub">
            Define credenciales y asigna permisos de acceso.
          </div>
        </div>

        <div class="hero-stats">
          <div class="mini-stat">
            <div class="mini-stat-label">Tipo</div>
            <div class="mini-stat-value">Cuenta interna</div>
          </div>
        </div>
      </section>

      <!-- MENSAJES -->
      {% if messages %}
        <div class="mb-3">
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} rounded-4 mb-2">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <!-- FORMULARIO -->
      <main class="app-card app-card-pro">
        <form method="post" action="" novalidate>
          {% csrf_token %}

          <div class="row g-4">

            <!-- DATOS -->
            <div class="col-lg-7">
              <section class="panel panel-pro">
                <div class="panel-head">
                  <div>
                    <div class="panel-title">Datos del usuario</div>
                    <div class="panel-sub">Información básica y credenciales.</div>
                  </div>
                </div>

                <div class="panel-body">
                  <div class="row g-3">

                    <div class="col-md-6">
                      <label class="form-label">Usuario</label>
                      <input name="username" class="form-control"
                             placeholder="ej: admin_guard"
                             autocomplete="username" required>
                      <div class="form-text">Debe ser único.</div>
                    </div>

                    <div class="col-md-6">
                      <label class="form-label">Contraseña</label>
                      <input id="password" name="password" type="password"
                             class="form-control"
                             autocomplete="new-password" required>

                      <div class="d-flex justify-content-between align-items-center mt-2">
                        <div class="form-text m-0">Mínimo 8 caracteres.</div>
                        <button type="button" id="togglePass" class="btn btn-outline-secondary btn-sm btn-soft">
                          Mostrar
                        </button>
                      </div>
                    </div>

                    <div class="col-md-4">
                      <label class="form-label">Nombre</label>
                      <input name="first_name" class="form-control">
                    </div>

                    <div class="col-md-4">
                      <label class="form-label">Apellido</label>
                      <input name="last_name" class="form-control">
                    </div>

                    <div class="col-md-4">
                      <label class="form-label">Correo</label>
                      <input name="email" type="email"
                             class="form-control"
                             autocomplete="email">
                    </div>

                  </div>
                </div>
              </section>
            </div>

            <!-- PERMISOS -->
            <div class="col-lg-5">
              <section class="panel panel-pro">
                <div class="panel-head">
                  <div>
                    <div class="panel-title">Rol y permisos</div>
                    <div class="panel-sub">Controla el nivel de acceso.</div>
                  </div>
                </div>

                <div class="panel-body">
                  <div class="mb-3">
                    <label class="form-label">Grupo</label>
                    <select name="group" class="form-select">
                      <option value="">Sin grupo</option>
                      {% for g in groups %}
                        <option value="{{ g.id }}">{{ g.name }}</option>
                      {% endfor %}
                    </select>
                    <div class="form-text">Define permisos por grupo.</div>
                  </div>

                  <div class="checks-card">
                    <div class="form-check">
                      <input name="is_active" type="checkbox"
                             class="form-check-input" checked id="is_active">
                      <label class="form-check-label" for="is_active">
                        Usuario activo
                      </label>
                    </div>

                    <div class="form-check mt-2">
                      <input name="is_staff" type="checkbox"
                             class="form-check-input" id="is_staff">
                      <label class="form-check-label" for="is_staff">
                        Acceso administrativo
                      </label>
                    </div>

                    <div class="form-check mt-2">
                      <input name="is_superuser" type="checkbox"
                             class="form-check-input" id="is_superuser">
                      <label class="form-check-label" for="is_superuser">
                        Acceso total
                      </label>
                    </div>
                  </div>

                  <div class="alert alert-warning rounded-4 mt-3 mb-0">
                    Usa acceso total solo para administradores principales.
                  </div>
                </div>
              </section>

              <div class="d-flex flex-column flex-sm-row gap-2 mt-3">
                <button class="btn btn-primary-custom flex-fill">
                  Crear usuario
                </button>
                <a href="/app/" class="btn btn-outline-secondary btn-soft flex-fill">
                  Cancelar
                </a>
              </div>
            </div>

          </div>
        </form>
      </main>

    </div>
  </div>

  <script>
    const pass = document.getElementById('password');
    const toggle = document.getElementById('togglePass');
    toggle?.addEventListener('click', () => {
      const hidden = pass.type === 'password';
      pass.type = hidden ? 'text' : 'password';
      toggle.textContent = hidden ? 'Ocultar' : 'Mostrar';
    });
  </script>

</body>
</html>
