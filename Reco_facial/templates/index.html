{% load static %}
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Reconocimiento Facial</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/login.css' %}">
  <link rel="icon" href="{% static 'images/logo.png' %}" type="image/png">
</head>

<body class="app-bg">

  <div class="page-wrap">
    <div class="container app-shell">

      <!-- TOPBAR -->
      <header class="topbar-pro">
        <div class="topbar-left">
          <div class="app-brand">
            <div class="logo">RF</div>
            <div>
              <div class="brand-title">Sistema de Acceso</div>
              <div class="breadcrumbs">
                <span>Administración</span>
                <span class="crumb-sep">/</span>
                <span class="crumb-active">Reconocimiento</span>
              </div>
            </div>
          </div>

          <div class="topbar-meta">
            <span class="chip chip-live">Cámara activa</span>
            <span class="chip chip-muted">Detección automática</span>
          </div>
        </div>

        <div class="topbar-actions">
          {% if request.user.is_authenticated and is_admin %}
            <a href="/create_users/" class="btn btn-outline-secondary btn-sm btn-soft">
              Crear usuarios
            </a>
          {% endif %}
          <a href="/register" class="btn btn-primary-custom btn-sm">
            Registrar estudiante
          </a>
          <a href="/logout/" class="btn btn-outline-danger btn-sm btn-soft">
            Cerrar sesión
          </a>
        </div>
      </header>

      <!-- HERO -->
      <section class="hero-strip">
        <div class="hero-copy">
          <div class="hero-title">Reconocimiento facial en vivo</div>
          <div class="hero-sub">
            Detecta estudiantes automáticamente usando la cámara.
          </div>
        </div>

        <div class="hero-stats">
          <div class="mini-stat">
            <div class="mini-stat-label">Resolución</div>
            <div class="mini-stat-value">640×480</div>
          </div>
          <div class="mini-stat">
            <div class="mini-stat-label">Estado</div>
            <div class="mini-stat-value" id="cameraStatus">Iniciando</div>
          </div>
        </div>
      </section>

      <!-- CONTENIDO -->
      <main class="app-card app-card-pro">
        <div class="row g-4">

          <!-- CÁMARA -->
          <div class="col-lg-8">
            <section class="panel panel-pro">
              <div class="panel-head">
                <div>
                  <div class="panel-title">Cámara</div>
                  <div class="panel-sub">Autoriza el acceso a la cámara si el navegador lo solicita.</div>
                </div>
                <div class="panel-right">
                  <span class="pill">LIVE</span>
                </div>
              </div>

              <div class="video-shell">
                <div class="video-topline"></div>
                <div class="video-wrapper">
                  <video id="video" autoplay muted playsinline></video>
                  <canvas id="overlay"></canvas>
                </div>
              </div>

              <div class="panel-foot">
                <button id="detectBtn" class="btn btn-primary-custom btn-sm">
                  Detectar ahora
                </button>
                <button class="btn btn-outline-secondary btn-sm btn-soft" type="button" onclick="location.reload()">
                  Reiniciar
                </button>
                <span class="sep">•</span>
                <span class="muted">Mantén el rostro centrado y bien iluminado</span>
              </div>
            </section>
          </div>

          <!-- LISTA -->
          <div class="col-lg-4">
            <section class="panel panel-pro">
              <div class="panel-head">
                <div>
                  <div class="panel-title">Estudiantes registrados</div>
                  <div class="panel-sub">Base de datos del sistema</div>
                </div>
                <span class="count-pill" id="studentsCount">0</span>
              </div>

              <div class="panel-body">
                <input id="studentSearch" class="table-search w-100 mb-3"
                       placeholder="Buscar por nombre o carrera">

                <div class="students-scroll list-pro">
                  <ul id="studentsList" class="list-group"></ul>
                </div>

                <div class="panel-hint">
                  La lista se actualiza automáticamente.
                </div>
              </div>
            </section>
          </div>

        </div>
      </main>

    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="{% static 'js/live.js' %}"></script>

</body>
</html>
